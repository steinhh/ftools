#!/usr/bin/env python3
"""
Generate C sorting network functions from network specifications.
"""

def parse_network_stage(stage_str):
    """Parse a stage like '[(0,1),(2,3),(4,5)]' into list of tuples."""
    stage_str = stage_str.strip()
    if not stage_str.startswith('[') or not stage_str.endswith(']'):
        return []
    
    pairs = []
    content = stage_str[1:-1]  # Remove outer brackets
    
    # Split by '),(' to get individual pairs
    parts = content.split('),(')
    for part in parts:
        # Clean up the part
        part = part.strip('()[]')
        if ',' in part:
            a, b = part.split(',')
            pairs.append((int(a), int(b)))
    
    return pairs

def generate_sort_function(n, stages, function_name=None):
    """Generate C code for a sorting network."""
    if function_name is None:
        function_name = f"sort{n}"
    
    total_comparators = sum(len(stage) for stage in stages)
    
    lines = []
    lines.append(f"/* Sorting network for {n} elements - {total_comparators} comparators */")
    lines.append(f"static inline void {function_name}(double *d)")
    lines.append("{")
    
    for stage_num, stage in enumerate(stages, 1):
        lines.append(f"  /* Stage {stage_num} */")
        
        # Group swaps in lines of 4 for readability
        for i in range(0, len(stage), 4):
            swap_group = stage[i:i+4]
            swap_strs = [f"SWAP(d[{a}], d[{b}]);" for a, b in swap_group]
            lines.append("  " + " ".join(swap_strs))
        
        if stage_num < len(stages):
            lines.append("")
    
    lines.append("}")
    lines.append("")
    
    return "\n".join(lines)

# Network specifications from your request
networks = {
    # sort25b - alternative 25-element network
    25: {
        'suffix': 'b',
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17),(18,19),(20,21),(22,23)]",
            "[(0,2),(1,3),(4,6),(5,7),(8,10),(9,11),(12,14),(13,15),(16,18),(17,19),(21,22),(23,24)]",
            "[(0,4),(1,5),(2,6),(3,7),(8,12),(9,13),(10,14),(11,15),(18,21),(20,23),(22,24)]",
            "[(0,8),(1,9),(2,10),(3,11),(4,12),(5,13),(6,14),(7,15),(16,20),(17,22),(19,24),(21,23)]",
            "[(1,18),(3,21),(5,23),(6,19),(11,14),(15,24)]",
            "[(1,16),(3,17),(6,9),(7,11),(13,19),(14,23)]",
            "[(0,1),(2,16),(3,8),(7,20),(10,13),(11,22),(15,23)]",
            "[(1,2),(5,10),(7,18),(11,21),(15,20),(19,22)]",
            "[(4,7),(5,6),(9,18),(10,17),(11,12),(13,21),(14,15),(19,20),(22,23)]",
            "[(3,4),(7,8),(9,10),(11,16),(12,17),(13,18),(19,21),(20,22)]",
            "[(1,3),(2,4),(5,11),(6,16),(7,9),(8,10),(12,13),(14,19),(15,18)]",
            "[(2,3),(5,7),(6,9),(8,11),(10,16),(12,14),(15,17)]",
            "[(3,5),(4,6),(7,8),(9,11),(10,12),(13,14),(15,16),(17,18)]",
            "[(4,7),(6,8),(9,10),(11,12),(13,15),(14,16),(17,19),(18,21)]",
            "[(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17),(18,19),(20,21)]"
        ]
    },
    
    24: {
        'stages': [
            "[(0,20),(1,12),(2,16),(3,23),(4,6),(5,10),(7,21),(8,14),(9,15),(11,22),(13,18),(17,19)]",
            "[(0,3),(1,11),(2,7),(4,17),(5,13),(6,19),(8,9),(10,18),(12,22),(14,15),(16,21),(20,23)]",
            "[(0,1),(2,4),(3,12),(5,8),(6,9),(7,10),(11,20),(13,16),(14,17),(15,18),(19,21),(22,23)]",
            "[(2,5),(4,8),(6,11),(7,14),(9,16),(12,17),(15,19),(18,21)]",
            "[(1,8),(3,14),(4,7),(9,20),(10,12),(11,13),(15,22),(16,19)]",
            "[(0,7),(1,5),(3,4),(6,11),(8,15),(9,14),(10,13),(12,17),(16,23),(18,22),(19,20)]",
            "[(0,2),(1,6),(4,7),(5,9),(8,10),(13,15),(14,18),(16,19),(17,22),(21,23)]",
            "[(2,3),(4,5),(6,8),(7,9),(10,11),(12,13),(14,16),(15,17),(18,19),(20,21)]",
            "[(1,2),(3,6),(4,10),(7,8),(9,11),(12,14),(13,19),(15,16),(17,20),(21,22)]",
            "[(2,3),(5,10),(6,7),(8,9),(13,18),(14,15),(16,17),(20,21)]",
            "[(3,4),(5,7),(10,12),(11,13),(16,18),(19,20)]",
            "[(4,6),(8,10),(9,12),(11,14),(13,15),(17,19)]",
            "[(5,6),(7,8),(9,10),(11,12),(13,14),(15,16),(17,18)]"
        ]
    },
    
    23: {
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17),(18,19),(20,21)]",
            "[(0,2),(1,3),(4,6),(5,7),(8,10),(9,11),(12,14),(13,15),(16,18),(17,19),(21,22)]",
            "[(0,4),(1,5),(2,6),(3,7),(8,12),(9,13),(10,14),(11,15),(17,21),(18,20),(19,22)]",
            "[(0,8),(1,9),(2,10),(3,11),(4,12),(5,13),(6,14),(7,15)]",
            "[(1,2),(5,18),(7,19),(9,16),(10,21),(12,20),(15,22)]",
            "[(5,9),(6,7),(10,18),(11,21),(12,17),(13,20),(14,15)]",
            "[(3,17),(6,16),(7,14),(8,12),(15,19),(20,21)]",
            "[(3,4),(5,8),(6,10),(9,12),(13,16),(14,15),(17,18),(19,21)]",
            "[(0,5),(1,8),(2,12),(3,9),(4,10),(7,13),(11,17),(14,16),(18,20)]",
            "[(2,6),(3,5),(4,8),(7,11),(10,12),(13,18),(14,17),(15,20)]",
            "[(1,3),(2,5),(6,9),(7,10),(11,13),(12,14),(15,18),(16,17),(19,20)]",
            "[(2,3),(4,6),(8,9),(11,12),(13,14),(15,16),(17,19)]",
            "[(3,4),(5,6),(7,8),(9,10),(12,13),(14,15),(17,18)]",
            "[(4,5),(6,7),(8,9),(10,11),(16,17)]"
        ]
    },
    
    22: {
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17),(18,19),(20,21)]",
            "[(0,2),(1,3),(4,6),(5,7),(8,12),(9,13),(14,16),(15,17),(18,20),(19,21)]",
            "[(0,4),(1,5),(2,6),(3,7),(8,10),(9,12),(11,13),(14,18),(15,19),(16,20),(17,21)]",
            "[(0,14),(1,15),(2,18),(3,19),(4,16),(5,17),(6,20),(7,21),(9,11),(10,12)]",
            "[(2,8),(3,11),(6,9),(10,18),(12,15),(13,19)]",
            "[(0,2),(1,10),(3,16),(5,18),(6,14),(7,15),(8,12),(9,13),(11,20),(19,21)]",
            "[(2,6),(3,10),(4,8),(5,12),(9,16),(11,18),(13,17),(15,19)]",
            "[(1,4),(7,13),(8,14),(9,12),(17,20)]",
            "[(1,2),(3,8),(4,6),(7,11),(10,14),(13,18),(15,17),(19,20)]",
            "[(2,4),(5,10),(7,9),(11,16),(12,14),(17,19)]",
            "[(5,6),(7,8),(9,11),(10,12),(13,14),(15,16)]",
            "[(3,5),(6,7),(8,10),(9,12),(11,13),(14,15),(16,18)]",
            "[(3,4),(5,6),(7,8),(9,10),(11,12),(13,14),(15,16),(17,18)]"
        ]
    },
    
    21: {
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17),(18,19)]",
            "[(0,2),(1,3),(4,6),(5,7),(8,10),(9,11),(12,14),(13,15),(16,18),(17,19)]",
            "[(0,8),(1,9),(2,10),(3,11),(4,12),(5,13),(6,14),(7,15)]",
            "[(0,4),(1,5),(3,7),(6,20),(8,12),(9,13),(10,14),(15,19)]",
            "[(2,6),(3,18),(7,20)]",
            "[(2,16),(3,6),(5,18),(7,17),(11,20)]",
            "[(0,2),(3,8),(6,12),(7,10),(9,16),(11,15),(13,17),(14,18),(19,20)]",
            "[(1,7),(2,3),(4,9),(10,11),(13,16),(15,18),(17,19)]",
            "[(1,4),(5,10),(6,13),(7,8),(11,14),(12,16),(15,17),(18,19)]",
            "[(1,2),(3,4),(5,6),(10,12),(11,13),(14,16),(17,18)]",
            "[(2,3),(4,5),(6,9),(10,11),(12,13),(14,15),(16,17)]",
            "[(6,7),(8,9),(15,16)]",
            "[(4,6),(7,8),(9,12),(13,15)]",
            "[(3,4),(5,7),(8,10),(9,11),(12,14)]",
            "[(5,6),(7,8),(9,10),(11,12),(13,14)]"
        ]
    },
    
    20: {
        'stages': [
            "[(0,3),(1,7),(2,5),(4,8),(6,9),(10,13),(11,15),(12,18),(14,17),(16,19)]",
            "[(0,14),(1,11),(2,16),(3,17),(4,12),(5,19),(6,10),(7,15),(8,18),(9,13)]",
            "[(0,4),(1,2),(3,8),(5,7),(11,16),(12,14),(15,19),(17,18)]",
            "[(1,6),(2,12),(3,5),(4,11),(7,17),(8,15),(13,18),(14,16)]",
            "[(0,1),(2,6),(7,10),(9,12),(13,17),(18,19)]",
            "[(1,6),(5,9),(7,11),(8,12),(10,14),(13,18)]",
            "[(3,5),(4,7),(8,10),(9,11),(12,15),(14,16)]",
            "[(1,3),(2,4),(5,7),(6,10),(9,13),(12,14),(15,17),(16,18)]",
            "[(1,2),(3,4),(6,7),(8,9),(10,11),(12,13),(15,16),(17,18)]",
            "[(2,3),(4,6),(5,8),(7,9),(10,12),(11,14),(13,15),(16,17)]",
            "[(4,5),(6,8),(7,10),(9,12),(11,13),(14,15)]",
            "[(3,4),(5,6),(7,8),(9,10),(11,12),(13,14),(15,16)]"
        ]
    },
    
    19: {
        'stages': [
            "[(0,12),(1,4),(2,8),(3,5),(6,17),(7,11),(9,14),(10,13),(15,16)]",
            "[(0,2),(1,7),(3,6),(4,11),(5,17),(8,12),(10,15),(13,16),(14,18)]",
            "[(3,10),(4,14),(5,15),(6,13),(7,9),(11,17),(16,18)]",
            "[(0,7),(1,10),(4,6),(9,15),(11,16),(12,17),(13,14)]",
            "[(0,3),(2,6),(5,7),(8,11),(12,16)]",
            "[(1,8),(2,9),(3,4),(6,15),(7,13),(10,11),(12,18)]",
            "[(1,3),(2,5),(6,9),(7,12),(8,10),(11,14),(17,18)]",
            "[(0,1),(2,3),(4,8),(6,10),(9,12),(14,15),(16,17)]",
            "[(1,2),(5,8),(6,7),(9,11),(10,13),(14,16),(15,17)]",
            "[(3,6),(4,5),(7,9),(8,10),(11,12),(13,14),(15,16)]",
            "[(3,4),(5,6),(7,8),(9,10),(11,13),(12,14)]",
            "[(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15)]"
        ]
    },
    
    18: {
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13),(14,15),(16,17)]",
            "[(0,2),(1,3),(4,12),(5,13),(6,8),(9,11),(14,16),(15,17)]",
            "[(0,14),(1,16),(2,15),(3,17)]",
            "[(0,6),(1,10),(2,9),(7,16),(8,15),(11,17)]",
            "[(1,4),(3,9),(5,7),(8,14),(10,12),(13,16)]",
            "[(0,1),(2,5),(3,13),(4,14),(7,9),(8,10),(12,15),(16,17)]",
            "[(1,2),(3,5),(4,6),(11,13),(12,14),(15,16)]",
            "[(4,8),(5,12),(6,10),(7,11),(9,13)]",
            "[(1,4),(2,8),(3,6),(5,7),(9,15),(10,12),(11,14),(13,16)]",
            "[(2,4),(5,8),(6,10),(7,11),(9,12),(13,15)]",
            "[(3,5),(6,8),(7,10),(9,11),(12,14)]",
            "[(3,4),(5,6),(7,8),(9,10),(11,12),(13,14)]"
        ]
    },
    
    17: {
        'stages': [
            "[(0,11),(1,15),(2,10),(3,5),(4,6),(8,12),(9,16),(13,14)]",
            "[(0,6),(1,13),(2,8),(4,14),(5,15),(7,11)]",
            "[(0,8),(3,7),(4,9),(6,16),(10,11),(12,14)]",
            "[(0,2),(1,4),(5,6),(7,13),(8,9),(10,12),(11,14),(15,16)]",
            "[(0,3),(2,5),(6,11),(7,10),(9,13),(12,15),(14,16)]",
            "[(0,1),(3,4),(5,10),(6,9),(7,8),(11,15),(13,14)]",
            "[(1,2),(3,7),(4,8),(6,12),(11,13),(14,15)]",
            "[(1,3),(2,7),(4,5),(9,11),(10,12),(13,14)]",
            "[(2,3),(4,6),(5,7),(8,10)]",
            "[(3,4),(6,8),(7,9),(10,12)]",
            "[(5,6),(7,8),(9,10),(11,12)]",
            "[(4,5),(6,7),(8,9),(10,11),(12,13)]"
        ]
    },
    
    16: {
        'stages': [
            "[(0,13),(1,12),(2,15),(3,14),(4,8),(5,6),(7,11),(9,10)]",
            "[(0,5),(1,7),(2,9),(3,4),(6,13),(8,14),(10,15),(11,12)]",
            "[(0,1),(2,3),(4,5),(6,8),(7,9),(10,11),(12,13),(14,15)]",
            "[(0,2),(1,3),(4,10),(5,11),(6,7),(8,9),(12,14),(13,15)]",
            "[(1,2),(3,12),(4,6),(5,7),(8,10),(9,11),(13,14)]",
            "[(1,4),(2,6),(5,8),(7,10),(9,13),(11,14)]",
            "[(2,4),(3,6),(9,12),(11,13)]",
            "[(3,5),(6,8),(7,9),(10,12)]",
            "[(3,4),(5,6),(7,8),(9,10),(11,12)]",
            "[(6,7),(8,9)]"
        ]
    },
    
    15: {
        'stages': [
            "[(1,2),(3,10),(4,14),(5,8),(6,13),(7,12),(9,11)]",
            "[(0,14),(1,5),(2,8),(3,7),(6,9),(10,12),(11,13)]",
            "[(0,7),(1,6),(2,9),(4,10),(5,11),(8,13),(12,14)]",
            "[(0,6),(2,4),(3,5),(7,11),(8,10),(9,12),(13,14)]",
            "[(0,3),(1,2),(4,7),(5,9),(6,8),(10,11),(12,13)]",
            "[(0,1),(2,3),(4,6),(7,9),(10,12),(11,13)]",
            "[(1,2),(3,5),(8,10),(11,12)]",
            "[(3,4),(5,6),(7,8),(9,10)]",
            "[(2,3),(4,5),(6,7),(8,9),(10,11)]",
            "[(5,6),(7,8)]"
        ]
    },
    
    14: {
        'stages': [
            "[(0,1),(2,3),(4,5),(6,7),(8,9),(10,11),(12,13)]",
            "[(0,2),(1,3),(4,8),(5,9),(10,12),(11,13)]",
            "[(0,4),(1,2),(3,7),(5,8),(6,10),(9,13),(11,12)]",
            "[(0,6),(1,5),(3,9),(4,10),(7,13),(8,12)]",
            "[(2,10),(3,11),(4,6),(7,9)]",
            "[(1,3),(2,8),(5,11),(6,7),(10,12)]",
            "[(1,4),(2,6),(3,5),(7,11),(8,10),(9,12)]",
            "[(2,4),(3,6),(5,8),(7,10),(9,11)]",
            "[(3,4),(5,6),(7,8),(9,10)]",
            "[(6,7)]"
        ]
    },
    
    13: {
        'stages': [
            "[(0,12),(1,10),(2,9),(3,7),(5,11),(6,8)]",
            "[(1,6),(2,3),(4,11),(7,9),(8,10)]",
            "[(0,4),(1,2),(3,6),(7,8),(9,10),(11,12)]",
            "[(4,6),(5,9),(8,11),(10,12)]",
            "[(0,5),(3,8),(4,7),(6,11),(9,10)]",
            "[(0,1),(2,5),(6,9),(7,8),(10,11)]",
            "[(1,3),(2,4),(5,6),(9,10)]",
            "[(1,2),(3,4),(5,7),(6,8)]",
            "[(2,3),(4,5),(6,7),(8,9)]",
            "[(3,4),(5,6)]"
        ]
    },
    
    12: {
        'stages': [
            "[(0,8),(1,7),(2,6),(3,11),(4,10),(5,9)]",
            "[(0,1),(2,5),(3,4),(6,9),(7,8),(10,11)]",
            "[(0,2),(1,6),(5,10),(9,11)]",
            "[(0,3),(1,2),(4,6),(5,7),(8,11),(9,10)]",
            "[(1,4),(3,5),(6,8),(7,10)]",
            "[(1,3),(2,5),(6,9),(8,10)]",
            "[(2,3),(4,5),(6,7),(8,9)]",
            "[(4,6),(5,7)]",
            "[(3,4),(5,6),(7,8)]"
        ]
    },
    
    11: {
        'stages': [
            "[(0,9),(1,6),(2,4),(3,7),(5,8)]",
            "[(0,1),(3,5),(4,10),(6,9),(7,8)]",
            "[(1,3),(2,5),(4,7),(8,10)]",
            "[(0,4),(1,2),(3,7),(5,9),(6,8)]",
            "[(0,1),(2,6),(4,5),(7,8),(9,10)]",
            "[(2,4),(3,6),(5,7),(8,9)]",
            "[(1,2),(3,4),(5,6),(7,8)]",
            "[(2,3),(4,5),(6,7)]"
        ]
    },
    
    8: {
        'stages': [
            "[(0,2),(1,3),(4,6),(5,7)]",
            "[(0,4),(1,5),(2,6),(3,7)]",
            "[(0,1),(2,3),(4,5),(6,7)]",
            "[(2,4),(3,5)]",
            "[(1,4),(3,6)]",
            "[(1,2),(3,4),(5,6)]"
        ]
    },
    
    7: {
        'stages': [
            "[(0,6),(2,3),(4,5)]",
            "[(0,2),(1,4),(3,6)]",
            "[(0,1),(2,5),(3,4)]",
            "[(1,2),(4,6)]",
            "[(2,3),(4,5)]",
            "[(1,2),(3,4),(5,6)]"
        ]
    },
    
    6: {
        'stages': [
            "[(0,5),(1,3),(2,4)]",
            "[(1,2),(3,4)]",
            "[(0,3),(2,5)]",
            "[(0,1),(2,3),(4,5)]",
            "[(1,2),(3,4)]"
        ]
    },
    
    5: {
        'stages': [
            "[(0,3),(1,4)]",
            "[(0,2),(1,3)]",
            "[(0,1),(2,4)]",
            "[(1,2),(3,4)]",
            "[(2,3)]"
        ]
    }
}

def main():
    print("// Auto-generated sorting networks")
    print("// Generated by generate_sorting_networks.py")
    print()
    
    for n in sorted(networks.keys()):
        info = networks[n]
        stages = [parse_network_stage(s) for s in info['stages']]
        
        suffix = info.get('suffix', '')
        function_name = f"sort{n}{suffix}"
        
        code = generate_sort_function(n, stages, function_name)
        print(code)

if __name__ == '__main__':
    main()
